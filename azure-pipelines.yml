trigger:
- master
pool:
  vmImage: 'ubuntu-latest'
variables:
  containerRegistryServiceConnection: dockerhub-gocompliant
  imageRepository: gocompliant/toolsuite
  tag: 1.0.0
steps:
- task: Maven@3
  inputs:
    mavenPomFile: 'pom.xml'
    goals: 'assembly:single'
    javaHomeOption: 'JDKVersion'
    mavenVersionOption: 'Default'
    publishJUnitResults: false
    mavenAuthenticateFeed: false
    effectivePomSkip: false
    sonarQubeRunAnalysis: false
- task: Docker@2
  displayName: dockerLogin
  inputs:
    command: login
    containerRegistry: $(containerRegistryServiceConnection)
- task: Docker@2
  displayName: dockerBuild
  inputs:
    repository: $(imageRepository)
    command: build
    Dockerfile: Dockerfile
    tags: |
      $(tag)
- task: Docker@2
  displayName: dockerPush
  inputs:
    command: push
    containerRegistry: $(containerRegistryServiceConnection)
    repository: $(imageRepository)
    tags: |
      $(tag)